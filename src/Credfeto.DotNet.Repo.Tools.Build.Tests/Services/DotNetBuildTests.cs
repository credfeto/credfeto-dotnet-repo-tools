using System.IO;
using System.Threading;
using System.Threading.Tasks;
using System.Xml;
using Credfeto.DotNet.Repo.Tools.Build.Interfaces;
using Credfeto.DotNet.Repo.Tools.Build.Services;
using FunFair.BuildCheck.Interfaces;
using FunFair.Test.Common;
using NSubstitute;
using Xunit;

namespace Credfeto.DotNet.Repo.Tools.Build.Tests.Services;

public sealed class DotNetBuildTests : TestBase
{
    private readonly IDotNetBuild _dotNetBuild;
    private readonly IProjectXmlLoader _projectXmlLoader;

    public DotNetBuildTests()
    {
        this._projectXmlLoader = GetSubstitute<IProjectXmlLoader>();
        this._dotNetBuild = new DotNetBuild(projectLoader: this._projectXmlLoader, this.GetTypedLogger<DotNetBuild>());
    }

    [Theory]
    [InlineData(nameof(Projects.PackableProject), true, false)]
    [InlineData(nameof(Projects.PackablePublishableDotNetTool), true, true)]
    [InlineData(nameof(Projects.XunitV3UnitTest), false, false)]
    public async Task LoadBuildSettingsAsync(string project, bool packable, bool publishable)
    {
        this.MockLoadProject(path: project);

        BuildSettings result = await this._dotNetBuild.LoadBuildSettingsAsync([project], cancellationToken: System.Threading.CancellationToken.None);

        Assert.Equal(expected: packable, actual: result.Packable);
        Assert.Equal(expected: publishable, actual: result.Publishable);
    }

    private void MockLoadProject(string path)
    {
        this._projectXmlLoader.LoadAsync(path: path, Arg.Any<CancellationToken>())
            .Returns(LoadDoc());

        XmlDocument LoadDoc()
        {
            string content = GetContent(path);

            XmlDocument doc = new();
            doc.LoadXml(content);

            return doc;
        }
    }

    private static string GetContent(string path)
    {
        string content = path switch
        {
            nameof(Projects.PackableProject) => Projects.PackableProject,
            nameof(Projects.PackablePublishableDotNetTool) => Projects.PackablePublishableDotNetTool,
            nameof(Projects.XunitV3UnitTest) => Projects.XunitV3UnitTest,
            _ => throw new FileNotFoundException(message: "No such file", fileName: path)
        };

        return content;
    }

    private static class Projects
    {
        public const string PackableProject =
            "<Project Sdk=\"Microsoft.NET.Sdk.Web\">\n  <PropertyGroup>\n    <AnalysisLevel>latest</AnalysisLevel>\n    <AnalysisMode>AllEnabledByDefault</AnalysisMode>\n    <CodeAnalysisRuleSet>$(SolutionDir)\\CodeAnalysis.ruleset</CodeAnalysisRuleSet>\n    <CodeAnalysisTreatWarningsAsErrors>true</CodeAnalysisTreatWarningsAsErrors>\n    <DebuggerSupport>true</DebuggerSupport>\n    <Description>FunFair Common Test Infrastructure for building xUnit tests on top of.</Description>\n    <DisableImplicitNuGetFallbackFolder>true</DisableImplicitNuGetFallbackFolder>\n    <EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>true</EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>\n    <EnableNETAnalyzers>true</EnableNETAnalyzers>\n    <EnablePackageValidation>true</EnablePackageValidation>\n    <EnableTrimAnalyzer>false</EnableTrimAnalyzer>\n    <EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>\n    <EnforceExtendedAnalyzerRules>false</EnforceExtendedAnalyzerRules>\n    <FFTestProject>true</FFTestProject>\n    <Features>strict;flow-analysis</Features>\n    <GenerateDocumentationFile>false</GenerateDocumentationFile>\n    <GenerateNeutralResourcesLanguageAttribute>true</GenerateNeutralResourcesLanguageAttribute>\n    <GenerateSBOM>true</GenerateSBOM>\n    <IlcGenerateStackTraceData>false</IlcGenerateStackTraceData>\n    <IlcOptimizationPreference>Size</IlcOptimizationPreference>\n    <ImplicitUsings>disable</ImplicitUsings>\n    <IncludeOpenAPIAnalyzers>true</IncludeOpenAPIAnalyzers>\n    <IncludeSymbols>true</IncludeSymbols>\n    <IsPackable>True</IsPackable>\n    <IsPublishable>False</IsPublishable>\n    <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>\n    <IsTrimmable>false</IsTrimmable>\n    <JsonSerializerIsReflectionEnabledByDefault>false</JsonSerializerIsReflectionEnabledByDefault>\n    <LangVersion>latest</LangVersion>\n    <NeutralLanguage>en</NeutralLanguage>\n    <NuGetAudit>true</NuGetAudit>\n    <NuGetAuditLevel>high</NuGetAuditLevel>\n    <NuGetAuditMode>direct</NuGetAuditMode>\n    <Nullable>enable</Nullable>\n    <OptimizationPreference>speed</OptimizationPreference>\n    <OutputType>Library</OutputType>\n    <PackageTags>FunFair, Test Helpers, Test</PackageTags>\n    <RepositoryUrl>https://github.com/funfair-tech/funfair-server-test</RepositoryUrl>\n    <RunAOTCompilation>false</RunAOTCompilation>\n    <SymbolPackageFormat>snupkg</SymbolPackageFormat>\n    <TargetFrameworks>net8.0;net9.0</TargetFrameworks>\n    <TestingPlatformDotnetTestSupport>true</TestingPlatformDotnetTestSupport>\n    <TieredCompilation>true</TieredCompilation>\n    <TieredPGO>true</TieredPGO>\n    <TreatWarningsAsErrors>True</TreatWarningsAsErrors>\n    <UseMicrosoftTestingPlatformRunner>true</UseMicrosoftTestingPlatformRunner>\n    <UseSystemResourceKeys>true</UseSystemResourceKeys>\n    <WarningsAsErrors />\n  </PropertyGroup>\n  <Import Project=\"$(SolutionDir)FunFair.props\" />\n  <ItemGroup>\n    <!-- error NU1903: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known high severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-5f2m-466j-3848\" />\n    <!-- error NU1902: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known moderate severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-x5qj-9vmx-7g6g\" />\n    <!-- error NU1903: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known high severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-xhfc-gr8f-ffwc\" />\n  </ItemGroup>\n  <!--  <ItemGroup>-->\n  <!--    <Content Remove=\"content\\testhost.dll\" />-->\n  <!--  </ItemGroup>-->\n  <ItemGroup>\n    <PackageReference Include=\"AutoBogus.NSubstitute\" Version=\"2.13.1\" />\n    <PackageReference Include=\"Bogus\" Version=\"35.6.3\" />\n    <PackageReference Include=\"Castle.Core\" Version=\"5.2.1\" />\n    <PackageReference Include=\"Dapper\" Version=\"2.1.66\" />\n    <PackageReference Include=\"FluentValidation\" Version=\"12.0.0\" />\n    <PackageReference Include=\"Meziantou.Extensions.Logging.Xunit.v3\" Version=\"1.1.4\" />\n    <PackageReference Include=\"Microsoft.Testing.Extensions.CodeCoverage\" Version=\"17.14.2\" />\n    <PackageReference Include=\"NonBlocking\" Version=\"2.1.2\" />\n    <PackageReference Include=\"NSubstitute\" Version=\"5.3.0\" />\n    <PackageReference Include=\"xunit.v3.assert\" Version=\"2.0.2\" />\n    <PackageReference Include=\"xunit.v3.extensibility.core\" Version=\"2.0.2\" />\n  </ItemGroup>\n  <ItemGroup>\n    <PackageReference Include=\"AsyncFixer\" Version=\"1.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"codecracker.CSharp\" Version=\"1.1.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Credfeto.Enumeration.Source.Generation\" Version=\"1.2.102.1190\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"CSharpIsNullAnalyzer\" Version=\"0.1.593\" PrivateAssets=\"all\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"FunFair.CodeAnalysis\" Version=\"7.1.0.1124\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Meziantou.Analyzer\" Version=\"2.0.201\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Microsoft.Sbom.Targets\" Version=\"4.0.3\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Microsoft.VisualStudio.Threading.Analyzers\" Version=\"17.14.15\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"NSubstitute.Analyzers.CSharp\" Version=\"1.0.17\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.DuplicateCodeAnalyzer\" Version=\"1.1.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.MaintainabilityAnalyzers\" Version=\"1.5.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Roslynator.Analyzers\" Version=\"4.13.1\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SecurityCodeScan.VS2019\" Version=\"5.6.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SerilogAnalyzer\" Version=\"0.15.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SmartAnalyzers.CSharpExtensions.Annotations\" Version=\"4.2.11\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SonarAnalyzer.CSharp\" Version=\"10.10.0.116381\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SourceLink.Create.CommandLine\" Version=\"2.8.3\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"ToStringWithoutOverrideAnalyzer\" Version=\"0.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"xunit.analyzers\" Version=\"1.21.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"xunit.runner.visualstudio\" Version=\"3.1.0\" PrivateAssets=\"All\" />\n  </ItemGroup>\n</Project>";

        public const string PackablePublishableDotNetTool =
            "<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <AnalysisLevel>latest</AnalysisLevel>\n    <AnalysisMode>AllEnabledByDefault</AnalysisMode>\n    <Authors>Mark Ridgwell</Authors>\n    <CodeAnalysisRuleSet>$(SolutionDir)\\CodeAnalysis.ruleset</CodeAnalysisRuleSet>\n    <CodeAnalysisTreatWarningsAsErrors>true</CodeAnalysisTreatWarningsAsErrors>\n    <Company>Mark Ridgwell</Company>\n    <Copyright>Mark Ridgwell</Copyright>\n    <DebuggerSupport>true</DebuggerSupport>\n    <Description>Dotnet Repository Update tools</Description>\n    <DisableImplicitNuGetFallbackFolder>true</DisableImplicitNuGetFallbackFolder>\n    <EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>true</EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>\n    <EnableNETAnalyzers>true</EnableNETAnalyzers>\n    <EnablePackageValidation>true</EnablePackageValidation>\n    <EnableRequestDelegateGenerator>true</EnableRequestDelegateGenerator>\n    <EnableTrimAnalyzer>false</EnableTrimAnalyzer>\n    <EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>\n    <EnforceExtendedAnalyzerRules>false</EnforceExtendedAnalyzerRules>\n    <Features>strict;flow-analysis</Features>\n    <GenerateNeutralResourcesLanguageAttribute>true</GenerateNeutralResourcesLanguageAttribute>\n    <GenerateSBOM>true</GenerateSBOM>\n    <IlcGenerateStackTraceData>false</IlcGenerateStackTraceData>\n    <IlcOptimizationPreference>Size</IlcOptimizationPreference>\n    <ImplicitUsings>disable</ImplicitUsings>\n    <IncludeOpenAPIAnalyzers>true</IncludeOpenAPIAnalyzers>\n    <IncludeSymbols>true</IncludeSymbols>\n    <IsPackable>true</IsPackable>\n    <IsPublishable>true</IsPublishable>\n    <IsTrimmable>false</IsTrimmable>\n    <JsonSerializerIsReflectionEnabledByDefault>false</JsonSerializerIsReflectionEnabledByDefault>\n    <LangVersion>latest</LangVersion>\n    <NeutralLanguage>en-GB</NeutralLanguage>\n    <NuGetAudit>true</NuGetAudit>\n    <NuGetAuditLevel>low</NuGetAuditLevel>\n    <NuGetAuditMode>direct</NuGetAuditMode>\n    <Nullable>enable</Nullable>\n    <OptimizationPreference>speed</OptimizationPreference>\n    <OutputType>Exe</OutputType>\n    <PackAsTool>true</PackAsTool>\n    <PackageLicenseExpression>MIT</PackageLicenseExpression>\n    <PackageReleaseNotes>$(ReleaseNotes)</PackageReleaseNotes>\n    <PackageTags>Nuget;update;tool;packages</PackageTags>\n    <Product>Repository Update Tool</Product>\n    <RepositoryType>git</RepositoryType>\n    <RepositoryUrl>https://github.com/credfeto/credfeto-dotnet-repo-tools</RepositoryUrl>\n    <RunAOTCompilation>false</RunAOTCompilation>\n    <RuntimeIdentifiers>win-x64;win-arm64;osx-x64;osx-arm64;linux-x64;linux-arm64</RuntimeIdentifiers>\n    <SymbolPackageFormat>snupkg</SymbolPackageFormat>\n    <TargetFrameworks>net8.0;net9.0</TargetFrameworks>\n    <TieredCompilation>true</TieredCompilation>\n    <TieredPGO>true</TieredPGO>\n    <ToolCommandName>updaterepo</ToolCommandName>\n    <TreatSpecificWarningsAsErrors />\n    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>\n    <UseSystemResourceKeys>true</UseSystemResourceKeys>\n    <ValidateExecutableReferencesMatchSelfContained>true</ValidateExecutableReferencesMatchSelfContained>\n    <WarningsAsErrors />\n  </PropertyGroup>\n  <ItemGroup>\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.Build\\Credfeto.DotNet.Repo.Tools.Build.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.CleanUp\\Credfeto.DotNet.Repo.Tools.CleanUp.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.DotNet\\Credfeto.DotNet.Repo.Tools.DotNet.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.Git\\Credfeto.DotNet.Repo.Tools.Git.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.Packages\\Credfeto.DotNet.Repo.Tools.Packages.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.Release\\Credfeto.DotNet.Repo.Tools.Release.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tools.TemplateUpdate\\Credfeto.DotNet.Repo.Tools.TemplateUpdate.csproj\" />\n    <ProjectReference Include=\"..\\Credfeto.DotNet.Repo.Tracking\\Credfeto.DotNet.Repo.Tracking.csproj\" />\n  </ItemGroup>\n  <ItemGroup>\n    <PackageReference Include=\"Cocona\" Version=\"2.2.0\" />\n    <PackageReference Include=\"Credfeto.Date\" Version=\"1.1.112.1102\" />\n    <PackageReference Include=\"Credfeto.Enumeration.Source.Generation.Attributes\" Version=\"1.2.103.1193\" />\n    <PackageReference Include=\"Serilog.Enrichers.Demystifier\" Version=\"1.0.3\" />\n    <PackageReference Include=\"Serilog.Enrichers.Environment\" Version=\"3.0.1\" />\n    <PackageReference Include=\"Serilog.Enrichers.Process\" Version=\"3.0.0\" />\n    <PackageReference Include=\"Serilog.Enrichers.Thread\" Version=\"4.0.0\" />\n    <PackageReference Include=\"Serilog.Extensions.Logging\" Version=\"9.0.2\" />\n    <PackageReference Include=\"Serilog.Sinks.Console\" Version=\"6.0.0\" />\n  </ItemGroup>\n  <ItemGroup>\n    <PackageReference Include=\"AsyncFixer\" Version=\"1.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"codecracker.CSharp\" Version=\"1.1.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Credfeto.Enumeration.Source.Generation\" Version=\"1.2.103.1193\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Credfeto.Version.Information.Generator\" Version=\"1.0.90.612\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"CSharpIsNullAnalyzer\" Version=\"0.1.593\" PrivateAssets=\"all\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"FunFair.CodeAnalysis\" Version=\"7.1.0.1124\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Meziantou.Analyzer\" Version=\"2.0.201\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Microsoft.Sbom.Targets\" Version=\"4.0.3\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Microsoft.VisualStudio.Threading.Analyzers\" Version=\"17.14.15\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Nullable.Extended.Analyzer\" Version=\"1.15.6581\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.DuplicateCodeAnalyzer\" Version=\"1.1.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.MaintainabilityAnalyzers\" Version=\"1.5.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Roslynator.Analyzers\" Version=\"4.13.1\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SecurityCodeScan.VS2019\" Version=\"5.6.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SmartAnalyzers.CSharpExtensions.Annotations\" Version=\"4.2.11\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SonarAnalyzer.CSharp\" Version=\"10.10.0.116381\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SourceLink.Create.CommandLine\" Version=\"2.8.3\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"ToStringWithoutOverrideAnalyzer\" Version=\"0.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n  </ItemGroup>\n</Project>";

        public const string XunitV3UnitTest =
            "<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <AnalysisLevel>latest</AnalysisLevel>\n    <AnalysisMode>AllEnabledByDefault</AnalysisMode>\n    <CodeAnalysisRuleSet>$(SolutionDir)\\CodeAnalysis.ruleset</CodeAnalysisRuleSet>\n    <CodeAnalysisTreatWarningsAsErrors>true</CodeAnalysisTreatWarningsAsErrors>\n    <DebuggerSupport>true</DebuggerSupport>\n    <DisableImplicitNuGetFallbackFolder>true</DisableImplicitNuGetFallbackFolder>\n    <EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>true</EnableMicrosoftExtensionsConfigurationBinderSourceGenerator>\n    <EnableNETAnalyzers>true</EnableNETAnalyzers>\n    <EnableTrimAnalyzer>true</EnableTrimAnalyzer>\n    <EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>\n    <EnforceExtendedAnalyzerRules>false</EnforceExtendedAnalyzerRules>\n    <Features>strict;flow-analysis</Features>\n    <GenerateNeutralResourcesLanguageAttribute>true</GenerateNeutralResourcesLanguageAttribute>\n    <IlcGenerateStackTraceData>false</IlcGenerateStackTraceData>\n    <IlcOptimizationPreference>Size</IlcOptimizationPreference>\n    <ImplicitUsings>disable</ImplicitUsings>\n    <IncludeOpenAPIAnalyzers>true</IncludeOpenAPIAnalyzers>\n    <IsPackable>false</IsPackable>\n    <IsPublishable>false</IsPublishable>\n    <IsTrimmable>false</IsTrimmable>\n    <JsonSerializerIsReflectionEnabledByDefault>true</JsonSerializerIsReflectionEnabledByDefault>\n    <LangVersion>latest</LangVersion>\n    <NuGetAudit>true</NuGetAudit>\n    <NuGetAuditLevel>high</NuGetAuditLevel>\n    <NuGetAuditMode>all</NuGetAuditMode>\n    <Nullable>enable</Nullable>\n    <OptimizationPreference>speed</OptimizationPreference>\n    <OutputType>Exe</OutputType>\n    <RunAOTCompilation>false</RunAOTCompilation>\n    <TargetFrameworks>net8.0;net9.0</TargetFrameworks>\n    <TestingPlatformDotnetTestSupport>true</TestingPlatformDotnetTestSupport>\n    <TieredCompilation>true</TieredCompilation>\n    <TieredPGO>true</TieredPGO>\n    <TreatWarningsAsErrors>True</TreatWarningsAsErrors>\n    <UseMicrosoftTestingPlatformRunner>true</UseMicrosoftTestingPlatformRunner>\n    <UseSystemResourceKeys>true</UseSystemResourceKeys>\n    <WarningsAsErrors />\n  </PropertyGroup>\n  <ItemGroup>\n    <!-- error NU1903: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known high severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-5f2m-466j-3848\" />\n    <!-- error NU1902: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known moderate severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-x5qj-9vmx-7g6g\" />\n    <!-- error NU1903: Warning As Error: Package 'System.Private.Uri' 4.3.0 has a known high severity vulnerability -->\n    <NuGetAuditSuppress Include=\"https://github.com/advisories/GHSA-xhfc-gr8f-ffwc\" />\n  </ItemGroup>\n  <ItemGroup>\n    <PackageReference Include=\"NSubstitute\" Version=\"5.3.0\" />\n    <PackageReference Include=\"xunit.v3\" Version=\"2.0.2\" />\n    <!--    <PackageReference Include=\"xunit.runner.visualstudio\" Version=\"3.0.2\" />-->\n    <!--    <PackageReference Include=\"Microsoft.NET.Test.Sdk\" Version=\"17.13.0\"/>-->\n  </ItemGroup>\n  <ItemGroup>\n    <ProjectReference Include=\"..\\FunFair.Test.Common\\FunFair.Test.Common.csproj\" />\n  </ItemGroup>\n  <ItemGroup>\n    <PackageReference Include=\"AsyncFixer\" Version=\"1.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"codecracker.CSharp\" Version=\"1.1.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Credfeto.Enumeration.Source.Generation\" Version=\"1.2.102.1190\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"CSharpIsNullAnalyzer\" Version=\"0.1.593\" PrivateAssets=\"all\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"FunFair.CodeAnalysis\" Version=\"7.1.0.1124\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Meziantou.Analyzer\" Version=\"2.0.201\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Microsoft.VisualStudio.Threading.Analyzers\" Version=\"17.14.15\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"NSubstitute.Analyzers.CSharp\" Version=\"1.0.17\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.DuplicateCodeAnalyzer\" Version=\"1.1.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Philips.CodeAnalysis.MaintainabilityAnalyzers\" Version=\"1.5.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"Roslynator.Analyzers\" Version=\"4.13.1\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SecurityCodeScan.VS2019\" Version=\"5.6.7\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SmartAnalyzers.CSharpExtensions.Annotations\" Version=\"4.2.11\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SonarAnalyzer.CSharp\" Version=\"10.10.0.116381\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"SourceLink.Create.CommandLine\" Version=\"2.8.3\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"ToStringWithoutOverrideAnalyzer\" Version=\"0.6.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n    <PackageReference Include=\"xunit.analyzers\" Version=\"1.21.0\" PrivateAssets=\"All\" ExcludeAssets=\"runtime\" />\n  </ItemGroup>\n</Project>";
    }
}